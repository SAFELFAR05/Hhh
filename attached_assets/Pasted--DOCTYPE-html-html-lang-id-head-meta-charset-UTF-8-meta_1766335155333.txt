<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>3D Large Infinity Rings</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <style>
        body { 
            margin: 0; 
            background: #000; 
            overflow: hidden; 
            touch-action: none;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        canvas { display: block; }
        .ui {
            position: absolute;
            bottom: 30px;
            color: rgba(255, 255, 255, 0.2);
            font-family: 'Segoe UI', sans-serif;
            font-size: 10px;
            letter-spacing: 3px;
            pointer-events: none;
            text-transform: uppercase;
        }
    </style>
</head>
<body>

    <canvas id="canvas"></canvas>
    <div class="ui">Rotate • Zoom • Pulse</div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        let rings = [];
        const ringCount = 800; // Jumlah ring banyak agar rapat
        let baseSize = 1;
        let zoomScale = 1.0;
        let pulseTick = 0; // Untuk animasi berdenyut
        
        let rotX = 0.004;
        let rotY = 0.004;
        let isInteracting = false;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            // Base size diperbesar agar jalur angka 8 lebih luas
            baseSize = Math.min(canvas.width, canvas.height) * 0.35;
        }

        class Ring {
            constructor(t) {
                this.t = t;
                this.updateCoordinates();
                // Gradasi warna neon
                this.color = `hsla(${(t * 60) % 360}, 80%, 60%, 0.6)`;
            }

            updateCoordinates() {
                // Skala jalur angka 8
                const scale = baseSize;
                this.x3d = Math.sin(this.t) * scale;
                this.y3d = (Math.sin(this.t) * Math.cos(this.t)) * scale * 2.8;
                this.z3d = Math.cos(this.t) * (scale * 1.2);
            }

            rotate() {
                // Rotasi Sumbu X
                let y1 = this.y3d * Math.cos(rotX) - this.z3d * Math.sin(rotX);
                let z1 = this.y3d * Math.sin(rotX) + this.z3d * Math.cos(rotX);
                this.y3d = y1; this.z3d = z1;

                // Rotasi Sumbu Y
                let x2 = this.x3d * Math.cos(rotY) + this.z3d * Math.sin(rotY);
                let z2 = -this.x3d * Math.sin(rotY) + this.z3d * Math.cos(rotY);
                this.x3d = x2; this.z3d = z2;
            }

            draw() {
                const zOffset = 1000;
                let perspective = zOffset / (zOffset + (this.z3d * zoomScale));
                
                let x2d = (this.x3d * zoomScale * perspective) + canvas.width / 2;
                let y2d = (this.y3d * zoomScale * perspective) + canvas.height / 2;

                // Animasi berdenyut pada ukuran ring
                const pulse = Math.sin(pulseTick + this.t * 2) * 15;
                const dynamicRadius = (45 + pulse) * perspective * zoomScale;

                ctx.strokeStyle = this.color;
                ctx.lineWidth = 0.8 * perspective; 
                
                ctx.beginPath();
                // Menggambar ring besar
                ctx.arc(x2d, y2d, Math.max(0.1, dynamicRadius), 0, Math.PI * 2);
                ctx.stroke();
            }
        }

        function init() {
            rings = [];
            for (let i = 0; i < ringCount; i++) {
                let t = (i / ringCount) * Math.PI * 2;
                rings.push(new Ring(t));
            }
        }

        // --- KONTROL (Zoom & Gestur) ---
        window.addEventListener('wheel', (e) => {
            zoomScale -= e.deltaY * 0.001;
            zoomScale = Math.max(0.1, Math.min(zoomScale, 5));
        });

        const mc = new Hammer.Manager(canvas);
        mc.add(new Hammer.Pan());
        mc.add(new Hammer.Pinch());

        mc.on("panmove", (e) => {
            isInteracting = true;
            rotY = e.velocityX * 0.04;
            rotX = e.velocityY * -0.04;
        });

        let startScale = 1;
        mc.on("pinchstart", () => startScale = zoomScale);
        mc.on("pinchmove", (e) => {
            zoomScale = Math.max(0.1, Math.min(startScale * e.scale, 5));
        });

        function animate() {
            // Clear screen total (Tajam Kristal)
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            pulseTick += 0.02; // Mengatur kecepatan denyutan

            if (!isInteracting) {
                // Gesekan (friction) agar rotasi melambat halus
                rotX *= 0.97;
                rotY *= 0.97;
                // Kecepatan putar otomatis minimum
                if (Math.abs(rotX) < 0.002) rotX = 0.002;
                if (Math.abs(rotY) < 0.002) rotY = 0.002;
            } else {
                isInteracting = false; 
            }

            // Urutan render berdasarkan kedalaman (Z-Sorting)
            // Agar ring depan menutupi ring belakang secara natural
            rings.sort((a, b) => b.z3d - a.z3d);

            rings.forEach(r => {
                r.rotate();
                r.draw();
            });

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', () => { resize(); init(); });
        resize();
        init();
        animate();
    </script>
</body>
</html>
